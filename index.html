<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pay via UPI</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin-top: 50px;
    }
    button {
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 12px 20px;
      font-size: 18px;
      border-radius: 8px;
      cursor: pointer;
    }
    #qr {
      margin-top: 20px;
    }
    #copyLink {
      margin-top: 15px;
      display: none;
      cursor: pointer;
      color: #007bff;
      text-decoration: underline;
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
</head>
<body>
<h2 id="payHeading">Pay ₹50 via UPI</h2>
<button id="payBtn">Pay Now</button>

<div id="qr" style="display: none;">
  <h3>Scan this QR with any UPI app</h3>
  <canvas id="qr-code"></canvas>
  <p id="copyLink" style="display:none; cursor:pointer; color:blue; text-decoration:underline;">
    Copy UPI Link
  </p>
</div>


  <script>
  // Function to read query parameters from URL
  function getQueryParam(param) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(param);
  }

  // Get amount and month from URL (fallback defaults if missing)
  const amount = getQueryParam("amount") || "50"; 
  const month = getQueryParam("month") || "Payment";

  // Build UPI link dynamically
  const upiLink = `upi://pay?pa=mlathkar@oksbi&pn=Malhar+Lathkar&am=${amount}&cu=INR&tn=${month}`;

  // Update heading text to reflect amount
  document.getElementById("payHeading").innerText = `Pay ₹${amount} via UPI`;

  document.getElementById("payBtn").addEventListener("click", function () {
    const isMobile = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);

    if (isMobile) {
      // Open UPI link directly
      const a = document.createElement("a");
      a.href = upiLink;
      a.click();
    } else {
      // Show QR code + copy link option for desktop
      document.getElementById("qr").style.display = "block";
      new QRious({
        element: document.getElementById("qr-code"),
        value: upiLink,
        size: 250
      });
      document.getElementById("copyLink").style.display = "block";
    }
  });

  // Copy UPI link for desktop users
  document.getElementById("copyLink").addEventListener("click", function () {
    navigator.clipboard.writeText(upiLink).then(() => {
      alert("UPI link copied! Open it on your mobile.");
    });
  });
</script>

</body>
</html>
